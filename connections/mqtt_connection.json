{   
    "name": "MQTT Connection",
    "connectionType": "mqtt",
    "connectionStatus": "open",
    "failoverEnabled" : true,
    "uri": "tcp://test.mosquitto.org:1883",
    "sources": [{
        "addresses": ["subsystems/org.eclipse.ditto:water-level-subsystem/#"],
        "authorizationContext": ["connection:mqtt"],
        "qos": 0
    }],
    "targets": [{
        "address": "subsystems/{{ thing:id }}/downlink",
        "topics" : [
            "_/_/things/twin/events",
            "_/_/things/live/messages"
        ],
        "authorizationContext": ["connection:mqtt"],
        "qos": 0
    }],
    "mappingContext": {
        "mappingEngine": "JavaScript",
        "options": {
            "incomingScript": "function mapToDittoProtocolMsg(headers, textPayload, bytePayload, contentType) {const jsonString = String.fromCharCode.apply(null, new Uint8Array(bytePayload));const jsonData = JSON.parse(jsonString); const thingId = jsonData.thingId.split(':'); if(headers['mqtt.topic'] === 'subsystems/org.eclipse.ditto:water-level-subsystem/status'){ return Ditto.buildDittoProtocolMsg( thingId[0], thingId[1], 'things','twin', 'commands','modify','/features/status/properties/status', headers, jsonData.status);} else {return null;}}"
        }
    }
    
 }